<?php
# Functions By TheBlaCkCoDeR | Tahar Amine | www.th3prodz.tk
function reverse_bing($ip){
$ch=curl_init();
$i=1;
while($i){
curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch,CURLOPT_URL,"http://www.bing.com/search?q=ip%3A$ip&first=$i");
curl_setopt($ch,CURLOPT_COOKIEFILE,'cookie.txt');
curl_setopt($ch,CURLOPT_COOKIEJAR,'cookie.txt');
curl_setopt($ch,CURLOPT_USERAGENT,'msnbot/1.0 (+http://search.msn.com/msnbot.htm)');
curl_setopt($ch,CURLOPT_ENCODING,"gzip, deflate, compress");
$data=curl_exec($ch);
preg_match_all('/<h2><a href="(.*?)"/',$data,$matches);
$links=array_unique($matches[1]);
foreach($links as $link){
$alllinks[]=correctit($link);
}
if(!preg_match('#"sw_next"#',$data)) break;
$i+=10;
}
curl_close($ch);
if(!empty($alllinks) && is_array($alllinks)){
return array_unique($alllinks);
}
}
function correctit($http){
if((strpos(trim($http), "http://") === 0) || (strpos(trim($http), "https://") === 0)){
return parse_url($http, PHP_URL_HOST);
}else{
return trim($http);
}
}
function joom_bing($ip){
$ch=curl_init();
$i=1;
while($i){
curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch,CURLOPT_URL,"http://www.bing.com/search?q=".urlencode("ip:$ip index.php?option=com")."&first=$i");
curl_setopt($ch,CURLOPT_COOKIEFILE,'cookie.txt');
curl_setopt($ch,CURLOPT_COOKIEJAR,'cookie.txt');
curl_setopt($ch,CURLOPT_USERAGENT,"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.1");
$data=curl_exec($ch);
preg_match_all('#<h2 class="sb_h3 cttl"><a href="(.*?)"#i',$data,$matches);
foreach($matches[1] as $link){
if(preg_match('/option/',$link)){
$parse=pathinfo($link);
$alllinks[]=$parse['dirname'];
}
}
if(!preg_match('#class="sb_pagN"#i',$data)) break;
$i+=10;
}
curl_close($ch);
if(!empty($alllinks) && is_array($alllinks)){
return array_filter(array_unique($alllinks));
}
}
function jos_composent($link){
$ch=curl_init();
curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch,CURLOPT_URL,$link.'/');
curl_setopt($ch,CURLOPT_SSL_VERIFYPEER,0);
curl_setopt($ch,CURLOPT_USERAGENT,'Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)');
curl_setopt($ch,CURLOPT_TIMEOUT,30);
$data=curl_exec($ch);
curl_close($ch);
preg_match_all('{option,(.*?)/}i',$data,$f);
preg_match_all('{option=(.*?)(&amp;|&|")}i',$data,$f2);
preg_match_all('{/components/(.*?)/}i',$data,$f3);
return array_filter(array_unique(array_merge($f2[1],$f[1],$f3[1])));
}
function com_ask_exploit($com){
$ch=curl_init();
curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch,CURLOPT_URL,'http://joomlaexploit.com/');
$data=curl_exec($ch);
curl_close($ch);
if(preg_match("#$com#",$data)){ return true;
}else{ return false; }
}
function wp_bing($ip){
$ch=curl_init();
$i=1;
while($i){
curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch,CURLOPT_URL,"http://www.bing.com/search?q=".urlencode("ip:$ip /?page_id=")."&first=$i");
curl_setopt($ch,CURLOPT_COOKIEFILE,'cookie.txt');
curl_setopt($ch,CURLOPT_COOKIEJAR,'cookie.txt');
curl_setopt($ch,CURLOPT_USERAGENT,"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.1");
$data=curl_exec($ch);
preg_match_all('#<h2 class="sb_h3 cttl"><a href="(.*?)"#i',$data,$matches);
foreach($matches[1] as $link){
if(preg_match('/page_id=/',$link)){
$parse=pathinfo($link);
$alllinks[]=$parse['dirname'];
}
}
if(!preg_match('#class="sb_pagN"#i',$data)) break;
$i+=10;
}
curl_close($ch);
if(!empty($alllinks) && is_array($alllinks)){
return array_filter(array_unique($alllinks));
}
}
function wp_plugins($link){
$ch=curl_init();
curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch,CURLOPT_URL,$link.'/');
curl_setopt($ch,CURLOPT_SSL_VERIFYPEER,0);
curl_setopt($ch,CURLOPT_USERAGENT,'Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)');
curl_setopt($ch,CURLOPT_TIMEOUT,30);
$data=curl_exec($ch);
curl_close($ch);
preg_match_all("/wp-content\/plugins\/(.*?)\//",$data,$f);
return array_filter(array_unique($f[1]));
}
function wp_ask_exploit($plug){
$ch=curl_init();
curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch,CURLOPT_URL,'http://wordpressexploit.com/');
$data=curl_exec($ch);
curl_close($ch);
if(preg_match("#$plug#",$data)){ return true;
}else{ return false; }
}
function bing_dorker($dork){
$ch=curl_init();
$i=1;
while($i){
curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch,CURLOPT_URL,"http://www.bing.com/search?q=".urlencode($dork)."&first=$i");
curl_setopt($ch,CURLOPT_COOKIEFILE,'cookie.txt');
curl_setopt($ch,CURLOPT_COOKIEJAR,'cookie.txt');
curl_setopt($ch,CURLOPT_USERAGENT,"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.1");
$data=curl_exec($ch);
preg_match_all('#<h2 class="sb_h3 cttl"><a href="(.*?)"#i',$data,$matches);
foreach($matches[1] as $link){
$alllinks[]=$link;
}
if(!preg_match('#class="sb_pagN"#i',$data)) break;
$i+=10;
}
curl_close($ch);
if(!empty($alllinks) && is_array($alllinks)){
return array_unique($alllinks);
}
}
function bing_subdomains($domain){
$ch=curl_init();
$i=1;
while($i){
curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch,CURLOPT_URL,"http://www.bing.com/search?q=domain%3A$domain&first=$i");
curl_setopt($ch,CURLOPT_COOKIEFILE,'cookie.txt');
curl_setopt($ch,CURLOPT_COOKIEJAR,'cookie.txt');
curl_setopt($ch,CURLOPT_USERAGENT,"SamsungI8910/SymbianOS/9.1 Series60/3.0");
$data=curl_exec($ch);
preg_match_all('#<h2 class="sb_h3 cttl"><a href="(.*?)"#i',$data,$matches);
foreach($matches[1] as $domain){
$SubDomains[]=cleanme($domain);
}
if(!preg_match('#class="sb_pagN"#i',$data)) break;
$i+=10;
}
curl_close($ch);
if(!empty($SubDomains) && is_array($SubDomains)){
return array_filter(array_unique($SubDomains));
}
}
function cleanme($domain){
return str_replace("www.","",parse_url($domain, PHP_URL_HOST));
}
function _Fix($site){ preg_match_all("#(.*?)?(.*?)=(.*?)#",$site,$res); return $res[2][0]."="; }
function get_txt_files($file){
$files=file($file);
foreach($files as $txt){
$txt=trim($txt);
$Files[]=$txt;
}
if(!empty($Files) && is_array($Files)){
return array_filter(array_unique($Files));
}
}